<div class="container-fluid py-4">
  <div class="row mb-4">
    <div class="col">
      <h2>Daily Passes Report</h2>
      <p class="text-muted">Export day-use pass data for a specific park and date.</p>
    </div>
  </div>

  <!-- Filters -->
  <div class="card mb-4">
    <div class="card-header">
      <h5 class="mb-0">Report Filters</h5>
    </div>
    <div class="card-body">
      <form [formGroup]="form" class="row g-3" (ngSubmit)="exportReport()">
        <!-- Park Selection -->
        <div class="col-md-4">
          <ngds-picklist-input
            [control]="form.get('collectionId')"
            [label]="'Park'"
            [placeholder]="'Select a park...'"
            [selectionListItems]="parkOptions"
            [resetButton]="true"
          ></ngds-picklist-input>
        </div>

        <!-- Facility Selection (Optional) -->
        <div class="col-md-4">
          <ngds-picklist-input
            [control]="form.get('facilityId')"
            [label]="'Facility (Optional)'"
            [placeholder]="'All facilities'"
            [selectionListItems]="facilityOptions"
            [resetButton]="true"
            [disabled]="!form.get('collectionId')?.value || facilitiesLoading"
          ></ngds-picklist-input>
          <small *ngIf="facilitiesLoading" class="text-muted">Loading facilities...</small>
        </div>

        <!-- Date Selection -->
        <div class="col-md-4">
          <ngds-date-input
            [control]="form.get('arrivalDate')"
            [label]="'Arrival Date'"
            [placeholder]="'Select a date'"
            [dateFormat]="'yyyy-LL-dd'"
            [dateDisplayFormat]="'yyyy-LL-dd'"
          ></ngds-date-input>
        </div>
      </form>
    </div>
  </div>

  <!-- Export Button -->
  <div class="row">
    <div class="col">
      <button
        type="button"
        class="btn btn-primary"
        [disabled]="!canExport() || isLoading"
        (click)="exportReport()"
      >
        <ng-container *ngIf="isLoading; else exportLabel">
          <i class="fa-solid fa-spinner fa-spin me-2"></i>
          Generating...
        </ng-container>
        <ng-template #exportLabel>
          <i class="fa-solid fa-download me-2"></i>
          Export CSV
        </ng-template>
      </button>
    </div>
  </div>

  <!-- Info Box -->
  <div class="row mt-4">
    <div class="col">
      <div class="alert alert-info">
        <i class="fa-solid fa-circle-info me-2"></i>
        <strong>Note:</strong> This report includes all day-use passes (vehicle parking and trail use) for the selected park and date.
        The exported CSV contains contact information, reservation details, and pass counts.
      </div>
    </div>
  </div>
</div>
